buildscript {
  ext.kotlin_version = "1.1.1"
  repositories {
    mavenCentral()
    maven { url "https://oss.sonatype.org/content/repositories/snapshots/" }
    maven { url 'http://dl.bintray.com/jetbrains/intellij-plugin-service' }
  }
}
plugins {
  id "org.jetbrains.intellij" version "0.2.17"
  id "org.jetbrains.kotlin.jvm" version "1.1.1"
}
apply plugin: "java"
apply plugin: "kotlin"
apply plugin: "idea"
apply plugin: "org.jetbrains.intellij"

sourceCompatibility = 1.8
targetCompatibility = 1.8

repositories {
  mavenCentral()
}

dependencies {
  testCompile "junit:junit:4.12"
}

sourceSets {
  main {
    java { srcDir "./src" }
    kotlin { srcDir "./src" }
    resources { srcDir "./resources" }
  }
  test {
    kotlin { srcDir "./test" }
  }
}

compileKotlin {
  kotlinOptions {
    jvmTarget = "1.8"
    apiVersion = "1.1"
    languageVersion = "1.1"
  }
}
kotlin {
  experimental { coroutines "enable" }
}

intellij {
  def ideVersion = System.getenv().getOrDefault("POMODORO_PLUGIN_IDEA_VERSION", "IC-172.3757.29")
  println("Using ide version: ${ideVersion}")
  version ideVersion
  pluginName "pomodoro"
  downloadSources true
  sameSinceUntilBuild false
  updateSinceUntilBuild false
}
